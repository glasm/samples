<?if(!isset($_POST['r'])){include('mainpage.php');exit;}session_start();if(!isset($_SESSION['dpGame_balance'])){$_SESSION['dpGame_balance']=500;$_SESSION['dpGame_chests']=0;}function getArr($a){for($b=array(),$d=0;$d<$a;$d++)$b[]=mt_rand()/mt_getrandmax()<0.75?rand(5,9):rand(0,4);$b[rand(0,9)*5]=10;$b[rand(0,9)*5+1]=10;$b[rand(0,9)*5+2]=10;$b[rand(0,9)*5+3]=10;$b[rand(0,9)*5+4]=10;return $b;}switch($_POST['r']){case  'stat':if($_SESSION['dpGame_balance']<25)$_SESSION['dpGame_balance']=500;$_SESSION['dpGame_bet']=5;$_SESSION['dpGame_time']=time()-8;die('ok;'.$_SESSION['dpGame_balance'].';5;'.implode(',',getArr(50)).';'.$_SESSION['dpGame_chests'].';'.(time()-file_get_contents('dpGameJP.php')).';'.(mt_rand()/mt_rand()));case  'bet':$e=$_SESSION['dpGame_bet'];$f=$_SESSION['dpGame_balance'];if($e==5&&$f>9){$e=10;}else if($e==10&&$f>14){$e=15;}else if($e==15&&$f>19){$e=20;}else if($e==20&&$f>24){$e=25;}else $e=5;$_SESSION['dpGame_bet']=$e;die('ok;'.$e);case  'start':if(time()-$_SESSION['dpGame_time']<7||$_SESSION['dpGame_bet']>$_SESSION['dpGame_balance'])die('err');$g=getArr(50);$h=$_SESSION['dpGame_bet'];$l=0;$o=array();$p=array('','.....','..........');for($q=0;$q<3;$q++){$t=$q*5;if($g[$t]>4&&$g[$t]==$g[$t+1]&&$g[$t]==$g[$t+2]&&$g[$t]==$g[$t+3]&&$g[$t]==$g[$t+4]){if($g[$t]==10){$l+=floor((time()-file_get_contents('dpGameJP.php'))/60);file_put_contents('dpGameJP.php',time()-60000);}else $l+=$h*($g[$t]-3)*5;$o[]=$p[$q].'#####'.$p[2-$q];}else if($g[$t+1]>4&&$g[$t+1]==$g[$t+2]&&$g[$t+1]==$g[$t+3]&&$g[$t+1]==$g[$t+4]){$l+=$h*($g[$t+1]-3)*($g[$t+1]==10?6:2);$o[]=$p[$q].'.####'.$p[2-$q];}else if($g[$t]>4&&$g[$t]==$g[$t+1]&&$g[$t]==$g[$t+2]&&$g[$t]==$g[$t+3]){$l+=$h*($g[$t]-3)*($g[$t]==10?6:2);$o[]=$p[$q].'####.'.$p[2-$q];}else if($g[$t+2]>4&&$g[$t+2]==$g[$t+3]&&$g[$t+2]==$g[$t+4]){$l+=$h*($g[$t+2]-3)*($g[$t+2]==10?3:1);$o[]=$p[$q].'..###'.$p[2-$q];}else if($g[$t]>4&&$g[$t]==$g[$t+1]&&$g[$t]==$g[$t+2]){$l+=$h*($g[$t]-3)*($g[$t]==10?3:1);$o[]=$p[$q].'###..'.$p[2-$q];}}if(floor($g[1]/5)*floor($g[3]/5)*floor($g[5]/5)*floor($g[7]/5)*floor($g[9]/5)*floor($g[11]/5)*floor($g[13]/5)==1){$l+=$h*($g[7]-2);$o[]='.#.#.#.#.#.#.#.';}$t=0;for($d=0;$d<15;$d++)if(floor($g[$d]/5)==0)$t++;if($t==15){$l+=500;$o[]='###############';}$t=0;$u='';for($d=0;$d<15;$d++)if($g[$d]==10){$u.='#';$t++;}else $u.='.';if($t>2){$o[]=$u;$_SESSION['dpGame_chests']+=$t-2;}$_SESSION['dpGame_balance']+=$l-$h;die('ok;'.($_SESSION['dpGame_balance']-$l).';'.$_SESSION['dpGame_balance'].';'.$_SESSION['dpGame_bet'].';'.$l.';'.implode(',',$g).';'.implode(',',$o).';'.$_SESSION['dpGame_chests'].';'.(time()-file_get_contents('dpGameJP.php')).';'.(mt_rand()/mt_rand()));case  'chest':if($_SESSION['dpGame_chests']<1)die('err');$_SESSION['dpGame_chests']--;$t=mt_rand()/mt_getrandmax();if($t<0.35){$l=0;}else if($t<0.55){$l=5;}else if($t<0.8){$l=10;}else if($t<0.9){$l=15;}else if($t<0.95){$l=25;}else if($t<0.99){$l=50;}else $l=100;$_SESSION['dpGame_balance']+=$l;die('ok;'.$_SESSION['dpGame_balance'].';'.$l.';'.$_SESSION['dpGame_chests'].';'.(mt_rand()/mt_rand()));}die('err');